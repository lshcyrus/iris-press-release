<![CDATA[<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Coverage Web App</title>
    <style>
        /* Base font sizes for desktop */
        .responsive-table { font-size: 16px; }
        .responsive-table td { padding: 8px; vertical-align: top; }

        /* Tablet sizes (768px - 1024px) */
        @media screen and (max-width: 1024px) {
          .responsive-table { font-size: 15px; }
          .responsive-table td { padding: 7px; }
        }

        /* Small tablet/large mobile (480px - 768px) */
        @media screen and (max-width: 768px) {
          .responsive-table { font-size: 14px; }
          .responsive-table table { border: 0; }
          .responsive-table thead { border: none; clip: rect(0 0 0 0); height: 1px; margin: -1px; overflow: hidden; padding: 0; position: absolute; width: 1px; }
          .responsive-table tr { border: 1px solid #ddd; border-radius: 8px; display: block; margin-bottom: 15px; padding: 12px; background: #f9f9f9; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
          .responsive-table td { border: none; display: block; padding: 6px 0; text-align: left; }
          .responsive-table td:before { content: attr(data-label) ": "; font-weight: bold; display: inline-block; width: 70px; margin-right: 8px; color: #333; vertical-align: top; font-size: 13px; }
          .responsive-table td[data-label="Date"] { white-space: nowrap; font-family: monospace; font-size: 13px; }
          .responsive-table td[data-label="Media"] { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; font-size: 13px; }
          .responsive-table td[data-label="Title"] { word-wrap: break-word; line-height: 1.3; font-size: 14px; }
          .responsive-table .year-header { background-color: #007cba !important; color: white !important; text-align: center; font-size: 16px; padding: 12px !important; margin-bottom: 15px; border-radius: 8px; }
          .responsive-table .year-header:before { content: none !important; }
        }

        /* Mobile phones (max 480px) */
        @media screen and (max-width: 480px) {
          .responsive-table { font-size: 13px; }
          .responsive-table tr { padding: 10px; margin-bottom: 12px; }
          .responsive-table td:before { width: 60px; margin-right: 6px; font-size: 12px; }
          .responsive-table td[data-label="Date"] { font-size: 12px; }
          .responsive-table td[data-label="Media"] { font-size: 12px; }
          .responsive-table td[data-label="Title"] { font-size: 13px; line-height: 1.2; }
          .responsive-table .year-header { font-size: 14px; padding: 10px !important; margin-bottom: 12px; }
        }

        /* Very small phones (max 360px) */
        @media screen and (max-width: 360px) {
          .responsive-table { font-size: 12px; }
          .responsive-table tr { padding: 8px; margin-bottom: 10px; }
          .responsive-table td:before { width: 55px; margin-right: 5px; font-size: 11px; }
          .responsive-table td[data-label="Date"] { font-size: 11px; }
          .responsive-table td[data-label="Media"] { font-size: 11px; }
          .responsive-table td[data-label="Title"] { font-size: 12px; line-height: 1.2; }
          .responsive-table .year-header { font-size: 13px; padding: 8px !important; margin-bottom: 10px; }
        }
    </style>
</head>
<body>
    <div class="responsive-table" style="overflow-x: auto;">
        <table id="data-table" border="1" cellspacing="0" cellpadding="5" style="border-collapse:collapse;width:100%;">
            <tbody></tbody>
        </table>
    </div>

    <script>
        async function fetchAndRenderData() {
            const sheetId = 'YOUR_SHEET_ID_HERE'; // Replace with your Google Sheet ID
            const sheetName = 'Sheet1'; // Replace with your sheet name if different
            const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

            try {
                const response = await fetch(url);
                const text = await response.text();
                // Parse the Google Sheets response
                const jsonString = text.replace(/.*google.visualization.Query.setResponse\(([\s\S]*)\);?/, '$1');
                const json = JSON.parse(jsonString);

                const rows = json.table.rows;

                // Assume first row is headers: Date, Media, Title, Link
                let data = rows.slice(1).map(row => ({
                    date: row.c[0]?.v || '',
                    media: row.c[1]?.v || '',
                    title: row.c[2]?.v || '',
                    link: row.c[3]?.v || ''
                }));

                // Filter out empty rows
                data = data.filter(item => item.date && item.media && item.title && item.link);

                // Sort by date descending
                data.sort((a, b) => new Date(b.date) - new Date(a.date));

                // Group by year
                const groups = {};
                data.forEach(item => {
                    const year = new Date(item.date).getFullYear();
                    if (!groups[year]) groups[year] = [];
                    groups[year].push(item);
                });

                const tbody = document.querySelector('#data-table tbody');
                Object.keys(groups).sort((a, b) => b - a).forEach(year => {
                    tbody.innerHTML += `<tr><td colspan="3" class="year-header" style="background-color:#eef; font-weight:bold; text-align:left;">${year}</td></tr>`;
                    groups[year].forEach(item => {
                        tbody.innerHTML += `<tr>
                            <td data-label="Date" style="width: 120px; min-width: 120px;">${item.date}</td>
                            <td data-label="Media" style="width: 150px;">${item.media}</td>
                            <td data-label="Title"><a href="${item.link}" target="_blank">${item.title}</a></td>
                        </tr>`;
                    });
                });
            } catch (error) {
                console.error('Error fetching data:', error);
                document.querySelector('#data-table tbody').innerHTML = '<tr><td colspan="3">Error loading data. Please check the Sheet ID and ensure the sheet is publicly accessible.</td></tr>';
            }
        }

        fetchAndRenderData();
    </script>
</body>
</html>]]> 